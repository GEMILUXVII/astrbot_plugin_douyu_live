<div align="center">
  <img src="LOGO.png" alt="AstrBot Douyu Plugin Logo" width="160" />
</div>

# <div align="center">AstrBot æ–—é±¼ç›´æ’­é€šçŸ¥æ’ä»¶</div>

<div align="center">
  <a href="#æ’ä»¶ç®€ä»‹">æ’ä»¶ç®€ä»‹</a> â€¢
  <a href="#åŠŸèƒ½ç‰¹æ€§">åŠŸèƒ½ç‰¹æ€§</a> â€¢
  <a href="#å‘½ä»¤åˆ—è¡¨">å‘½ä»¤åˆ—è¡¨</a> â€¢
  <a href="CHANGELOG.md">æ›´æ–°æ—¥å¿—</a>
</div>

<div align="center">
  <a href="#æ›´æ–°æ—¥å¿—"><img src="https://img.shields.io/badge/version-v1.4.0-9644F4?style=for-the-badge" alt="Version"></a>
  <a href="https://github.com/GEMILUXVII/astrbot_plugin_douyu_live/blob/master/LICENSE"><img src="https://img.shields.io/badge/license-AGPL--3.0-E53935?style=for-the-badge" alt="License"></a>
  <a href="https://www.python.org/downloads/"><img src="https://img.shields.io/badge/Python-3.10+-3776AB?style=for-the-badge&logo=python&logoColor=white" alt="Python"></a>
  <a href="https://github.com/AstrBotDevs/AstrBot"><img src="https://img.shields.io/badge/AstrBot-Compatible-00BFA5?style=for-the-badge&logo=robot&logoColor=white" alt="AstrBot Compatible"></a>
</div>

<div align="center">
  <a href="https://www.douyu.com/"><img src="https://img.shields.io/badge/Douyu-Live-FF9800?style=for-the-badge&logo=livejournal&logoColor=white" alt="Douyu"></a>
  <a href="https://github.com/NapNeko/NapCatQQ"><img src="https://img.shields.io/badge/NapCat-QQ-2196F3?style=for-the-badge&logo=qq&logoColor=white" alt="NapCat"></a>
  <a href="https://github.com/GEMILUXVII/astrbot_plugin_douyu_live/commits/master"><img src="https://img.shields.io/badge/updated-2025--12--02-0097A7?style=for-the-badge&logo=calendar&logoColor=white" alt="Last Updated"></a>
</div>

<div align="center"><em>å¤šæˆ¿é—´ç›‘æ§ï¼Œæ™ºèƒ½æ¨é€ï¼Œæ–—é±¼å¼€æ’­é€šçŸ¥å…¨è‡ªåŠ¨ï¼</em></div>

## æ’ä»¶ç®€ä»‹

AstrBot æ–—é±¼ç›´æ’­é€šçŸ¥æ’ä»¶ï¼Œæ”¯æŒå¤šæˆ¿é—´ç›‘æ§ã€è®¢é˜…æ¨é€ã€@å…¨ä½“æˆå‘˜ã€ç¤¼ç‰©æ’­æŠ¥ã€æ•°æ®æŒä¹…åŒ–ç­‰åŠŸèƒ½ã€‚é€‚ç”¨äº QQ ç¾¤ã€ç§èŠç­‰å¤šå¹³å°ï¼ŒåŠ©ä½ ä¸é”™è¿‡ä»»ä½•å¼€æ’­æ—¶åˆ»ï¼

## åŠŸèƒ½ç‰¹æ€§

- **å¤šæˆ¿é—´ç›‘æ§**ï¼šåŒæ—¶ç›‘æ§å¤šä¸ªæ–—é±¼ç›´æ’­é—´ï¼Œè‡ªåŠ¨æ£€æµ‹å¼€æ’­
- **è®¢é˜…æ¨é€**ï¼šç”¨æˆ·å¯è‡ªä¸»è®¢é˜…/å–æ¶ˆè®¢é˜…ï¼Œç²¾å‡†æ¨é€åˆ°ç¾¤/ç§èŠ
- **@å…¨ä½“æˆå‘˜**ï¼šæ”¯æŒå¼€æ’­æ—¶è‡ªåŠ¨ @å…¨ä½“æˆå‘˜ï¼ˆå¯é€‰ï¼‰
- **ç¤¼ç‰©æ’­æŠ¥**ï¼šæ”¯æŒç›´æ’­é—´ç¤¼ç‰©å®æ—¶æ’­æŠ¥ï¼Œå¯è¿‡æ»¤ä½ä»·å€¼ç¤¼ç‰©
- **ä¸‹æ’­é€šçŸ¥**ï¼šè‡ªåŠ¨æ¨é€ä¸‹æ’­æé†’å¹¶é™„å¸¦å½“æ¬¡ç›´æ’­æ—¶é•¿
- **ç›´æ’­æ€»ç»“**ï¼šä¸‹æ’­æ—¶è‡ªåŠ¨ç”Ÿæˆç¤¼ç‰©ç»Ÿè®¡æ€»ç»“ï¼ˆæ”¶ç¤¼æ•°é‡ã€é‡‘é¢ã€æ¦œä¸€å¤§å“¥ç­‰ï¼‰
- **æŠ—æŠ–åŠ¨æœºåˆ¶**ï¼šå†…ç½®çŠ¶æ€å†·å´ã€é‡è¯•ä¸è‡ªåŠ¨æ¢å¤ï¼Œé¿å…é‡å¤æˆ–æ¼æŠ¥
- **è‡ªåŠ¨è·å–ä¸»æ’­å**ï¼šæ·»åŠ æˆ¿é—´æ—¶è‡ªåŠ¨ä»æ–—é±¼è·å–ä¸»æ’­åç§°
- **æ•°æ®æŒä¹…åŒ–**ï¼šç›‘æ§ä¸è®¢é˜…æ•°æ®è‡ªåŠ¨ä¿å­˜ï¼Œé‡å¯ä¸ä¸¢å¤±ï¼ˆSQLiteï¼‰
- **æƒé™æ§åˆ¶**ï¼šæ·»åŠ /åˆ é™¤ç›´æ’­é—´éœ€ç®¡ç†å‘˜æƒé™
- **çŠ¶æ€æŸ¥è¯¢**ï¼šéšæ—¶æŸ¥çœ‹ç›‘æ§ä¸è®¢é˜…çŠ¶æ€

## å®‰è£…ä¸é…ç½®

1. **å®‰è£…ä¾èµ–**

   ```bash
   pip install pydouyu httpx
   ```

2. **å®‰è£…æ’ä»¶**

   å°†æœ¬æ’ä»¶ç›®å½•æ”¾å…¥ AstrBot çš„ `data/plugins/` ç›®å½•ä¸‹ï¼š

   ```
   data/plugins/astrbot_plugin_douyu_live/
   â”œâ”€â”€ main.py
   â”œâ”€â”€ metadata.yaml
   â”œâ”€â”€ requirements.txt
   â”œâ”€â”€ core/
   â”œâ”€â”€ models/
   â”œâ”€â”€ storage/
   â””â”€â”€ utils/
   ```

3. **é‡å¯/é‡è½½ AstrBot**

   åœ¨ WebUI é‡è½½æ’ä»¶ï¼Œæˆ–ç›´æ¥é‡å¯ AstrBotã€‚

## å‘½ä»¤åˆ—è¡¨

### ç®¡ç†å‘˜å‘½ä»¤

| å‘½ä»¤                                  | è¯´æ˜                | ç¤ºä¾‹                             |
| ------------------------------------- | ------------------- | -------------------------------- |
| `/douyu add <æˆ¿é—´å·> [åç§°]`          | æ·»åŠ ç›‘æ§ç›´æ’­é—´      | `/douyu add 12725169 æŸä¸»æ’­`     |
| `/douyu del <æˆ¿é—´å·>`                 | åˆ é™¤ç›‘æ§ç›´æ’­é—´      | `/douyu del 12725169`            |
| `/douyu atall <æˆ¿é—´å·> [on/off]`      | è®¾ç½® @å…¨ä½“æˆå‘˜      | `/douyu atall 12725169 on`       |
| `/douyu gift <æˆ¿é—´å·> [on/off]`       | å¼€å¯/å…³é—­ç¤¼ç‰©æ’­æŠ¥   | `/douyu gift 12725169 on`        |
| `/douyu giftfilter <æˆ¿é—´å·> [on/off]` | å¼€å¯/å…³é—­é«˜ä»·å€¼è¿‡æ»¤ | `/douyu giftfilter 12725169 off` |
| `/douyu summary <æˆ¿é—´å·> [on/off]`    | å¼€å¯/å…³é—­ç›´æ’­æ€»ç»“   | `/douyu summary 12725169 on`     |
| `/douyu restart [æˆ¿é—´å·]`             | é‡å¯ç›‘æ§            | `/douyu restart`                 |

### æ™®é€šç”¨æˆ·å‘½ä»¤

| å‘½ä»¤                    | è¯´æ˜           | ç¤ºä¾‹                    |
| ----------------------- | -------------- | ----------------------- |
| `/douyu ls`             | æŸ¥çœ‹ç›‘æ§åˆ—è¡¨   | `/douyu ls`             |
| `/douyu sub <æˆ¿é—´å·>`   | è®¢é˜…ç›´æ’­é—´é€šçŸ¥ | `/douyu sub 12725169`   |
| `/douyu unsub <æˆ¿é—´å·>` | å–æ¶ˆè®¢é˜…       | `/douyu unsub 12725169` |
| `/douyu mysub`          | æŸ¥çœ‹æˆ‘çš„è®¢é˜…   | `/douyu mysub`          |
| `/douyu status`         | æŸ¥çœ‹ç›‘æ§çŠ¶æ€   | `/douyu status`         |

## ä½¿ç”¨ç¤ºä¾‹

### æ·»åŠ ç›´æ’­é—´ï¼ˆç®¡ç†å‘˜ï¼‰

```
/douyu add 12725169
```

ä¸æä¾›åç§°æ—¶ï¼Œæ’ä»¶ä¼šè‡ªåŠ¨ä»æ–—é±¼è·å–ä¸»æ’­åç§°ã€‚

### ç”¨æˆ·è®¢é˜…

```
/douyu sub 12725169
```

### å¼€å¯ç¤¼ç‰©æ’­æŠ¥

```
/douyu gift 12725169 on
```

é»˜è®¤åªæ’­æŠ¥é«˜ä»·å€¼ç¤¼ç‰©ï¼ˆé£æœºåŠä»¥ä¸Šï¼‰ï¼Œå¦‚éœ€æ’­æŠ¥æ‰€æœ‰ç¤¼ç‰©ï¼š

```
/douyu giftfilter 12725169 off
```

### å¼€å¯ @å…¨ä½“æˆå‘˜

```
/douyu atall 12725169 on
```

### å¼€å¯ç›´æ’­æ€»ç»“

```
/douyu summary 12725169 on
```

ä¸‹æ’­æ—¶ä¼šè‡ªåŠ¨å‘é€ç¤¼ç‰©ç»Ÿè®¡æ€»ç»“ã€‚

### æŸ¥çœ‹ç›‘æ§çŠ¶æ€

```
/douyu status
```

## é€šçŸ¥æ ·ä¾‹

### å¼€æ’­é€šçŸ¥

```
@å…¨ä½“æˆå‘˜
æ–—é±¼ç›´æ’­å¼€æ’­é€šçŸ¥
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä¸»æ’­: æŸä¸»æ’­
æˆ¿é—´å·: 12725169
æ—¶é—´: 2024-01-01 20:00:00
é“¾æ¥: https://www.douyu.com/12725169
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
å¿«å»è§‚çœ‹å§ï¼
```

### ç¤¼ç‰©æ’­æŠ¥

```
æ–—é±¼ç›´æ’­ç¤¼ç‰©æ’­æŠ¥
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç›´æ’­é—´: æŸä¸»æ’­
ç”¨æˆ·: åœŸè±ªç”¨æˆ·
ç¤¼ç‰©: ç«ç®­ x1
æ—¶é—´: 20:30:45
```

### ä¸‹æ’­é€šçŸ¥

```
æ–—é±¼ç›´æ’­ä¸‹æ’­é€šçŸ¥
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä¸»æ’­: æŸä¸»æ’­
æˆ¿é—´å·: 12725169
æœ¬æ¬¡ç›´æ’­æ—¶é•¿: 45åˆ†é’Ÿ
ä¸‹æ’­æ—¶é—´: 2025-12-02 21:02:53
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ„Ÿè°¢è§‚çœ‹ï¼Œä¸‹æ¬¡å†è§ï¼
```

### ç›´æ’­æ€»ç»“

```
ğŸ“Š ç›´æ’­æ€»ç»“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç›´æ’­é—´: æŸä¸»æ’­
æˆ¿é—´å·: 12725169
ç›´æ’­æ—¶é•¿: 2å°æ—¶30åˆ†
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ ç¤¼ç‰©ç»Ÿè®¡
æ”¶ç¤¼æ¬¡æ•°: 156
ç¤¼ç‰©æ€»ä»·å€¼: Â¥1,234.50
é€ç¤¼äººæ•°: 42
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ† æ¦œä¸€å¤§å“¥: åœŸè±ªç”¨æˆ·
è´¡çŒ®: Â¥500.00
â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ„Ÿè°¢å¤§å®¶çš„æ”¯æŒï¼
```

## æ•°æ®å­˜å‚¨

æ’ä»¶æ•°æ®å­˜å‚¨äºï¼š

- **è®¢é˜…é…ç½®**: `data/plugin_data/astrbot_plugin_douyu_live/douyu_live_data.json`
- **ç›´æ’­ä¼šè¯**: `data/plugin_data/astrbot_plugin_douyu_live/sessions.db`ï¼ˆSQLiteï¼‰

JSON æ•°æ®ç»“æ„ç¤ºä¾‹ï¼š

```json
{
  "subscriptions": {
    "12725169": ["default:GroupMessage:123456789"]
  },
  "room_info": {
    "12725169": {
      "name": "ä¸»æ’­åç§°",
      "added_by": "ç®¡ç†å‘˜ID",
      "added_time": "2024-01-01 12:00:00",
      "at_all": true,
      "gift_notify": true,
      "high_value_only": true,
      "summary_notify": true
    }
  }
}
```

SQLite æ•°æ®åº“åŒ…å«ä»¥ä¸‹è¡¨ï¼š

- **sessions**: å­˜å‚¨æ¯åœºç›´æ’­çš„åŸºæœ¬ä¿¡æ¯ï¼ˆå¼€å§‹/ç»“æŸæ—¶é—´ã€ç¤¼ç‰©ç»Ÿè®¡ç­‰ï¼‰
- **gifts**: å­˜å‚¨æ¯åœºç›´æ’­çš„è¯¦ç»†ç¤¼ç‰©è®°å½•

## å¸¸è§é—®é¢˜

### Q: æç¤º "pydouyu åº“æœªå®‰è£…"

A: è¯·è¿è¡Œ `pip install pydouyu` å®‰è£…ä¾èµ–ã€‚

### Q: ç›‘æ§å¯åŠ¨å¤±è´¥

A: æ£€æŸ¥æˆ¿é—´å·æ˜¯å¦æ­£ç¡®ã€ç½‘ç»œæ˜¯å¦å¯ç”¨ï¼Œå¹¶æŸ¥çœ‹ AstrBot æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ã€‚

### Q: @å…¨ä½“æˆå‘˜ ä¸ç”Ÿæ•ˆ

A: è¯·ç¡®ä¿å·²å¼€å¯ @å…¨ä½“æˆå‘˜ï¼Œä¸”æœºå™¨äººæœ‰ç¾¤ç®¡ç†å‘˜æƒé™ï¼Œç¾¤è®¾ç½®å…è®¸ @å…¨ä½“æˆå‘˜ã€‚

### Q: æ”¶ä¸åˆ°å¼€æ’­é€šçŸ¥

A: æ£€æŸ¥ç›‘æ§çŠ¶æ€ã€è®¢é˜…çŠ¶æ€ï¼Œå¿…è¦æ—¶é‡å¯ç›‘æ§ã€‚

### Q: ç¤¼ç‰©æ’­æŠ¥å¤ªé¢‘ç¹

A: ä½¿ç”¨ `/douyu giftfilter æˆ¿é—´å· on` å¼€å¯é«˜ä»·å€¼è¿‡æ»¤ï¼Œåªæ’­æŠ¥é£æœºåŠä»¥ä¸Šçš„ç¤¼ç‰©ã€‚

### Q: é‡å¤æ”¶åˆ°é€šçŸ¥

A: å¯èƒ½å› ä¸»æ’­é¢‘ç¹å¼€å…³æ’­æˆ–æ’ä»¶é‡å¯å¯¼è‡´ï¼Œå±æ­£å¸¸å¶å‘ç°è±¡ã€‚

## ç›¸å…³é“¾æ¥

- [AstrBot å®˜æ–¹æ–‡æ¡£](https://astrbot.app/)
- [AstrBot æ’ä»¶å¼€å‘æŒ‡å—](https://astrbot.app/dev/plugin.html)
- [æ–—é±¼ç›´æ’­](https://www.douyu.com/)

## è®¸å¯è¯

[![](https://www.gnu.org/graphics/agplv3-155x51.png "AGPL v3 logo")](https://www.gnu.org/licenses/agpl-3.0.txt)

Copyright (C) 2025 GEMILUXVII

This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or any later version.

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License along with this program. If not, see <https://www.gnu.org/licenses/>.
